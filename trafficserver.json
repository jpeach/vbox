{
    "description": "Traffic Server QA Vagrant Boxes",

    "builders": [
        {
            "type": "virtualbox-iso",
            "name": "fedora-21",
            "guest_os_type": "Fedora_64",
            "iso_url": "http://download.fedoraproject.org/pub/fedora/linux/releases/21/Server/x86_64/iso/Fedora-Server-netinst-x86_64-21.iso",
            "iso_checksum": "56af126a50c227d779a200b414f68ea7bcf58e21c8035500cd21ba164f85b9b4",
            "iso_checksum_type": "sha256",
            "ssh_username": "vagrant",
            "ssh_password": "vagrant",
            "ssh_wait_timeout": "50000s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "http_directory": "manifests",
            "vboxmanage": [
                [ "modifyvm", "{{.Name}}", "--memory", "1024" ]
            ],
            "boot_command": [
                "<tab> ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora/fedora20.ks<enter>"
            ]
        }, {
            "type": "virtualbox-iso",
            "name": "fedora-20",
            "guest_os_type": "Fedora_64",
            "iso_url": "http://download.fedoraproject.org/pub/fedora/linux/releases/20/Fedora/x86_64/iso/Fedora-20-x86_64-netinst.iso",
            "iso_checksum": "376be7d4855ad6281cb139430606a782fd6189dcb01d7b61448e915802cc350f",
            "iso_checksum_type": "sha256",
            "ssh_username": "vagrant",
            "ssh_password": "vagrant",
            "ssh_wait_timeout": "50000s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "http_directory": "manifests",
            "vboxmanage": [
                [ "modifyvm", "{{.Name}}", "--memory", "1024" ]
            ],
            "boot_command": [
                "<tab> ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/fedora/fedora20.ks<enter>"
            ]
        }, {
            "type": "virtualbox-iso",
            "name": "centos-7.0",
            "guest_os_type": "RedHat_64",
            "iso_url": "http://mirrors.sonic.net/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-Minimal.iso",
            "iso_checksum": "e3afe3f1121d69c40cc23f0bafa05e5d",
            "iso_checksum_type": "md5",
            "ssh_username": "vagrant",
            "ssh_password": "vagrant",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "http_directory": "manifests",
            "boot_command": [
                "<tab> text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/centos/generic.ks<enter>"
            ]
        }, {
            "type": "virtualbox-iso",
            "name": "centos-6.5",
            "guest_os_type": "RedHat_64",
            "iso_url": "http://mirrors.sonic.net/centos/6.5/isos/x86_64/CentOS-6.5-x86_64-minimal.iso",
            "iso_checksum": "0d9dc37b5dd4befa1c440d2174e88a87",
            "iso_checksum_type": "md5",
            "ssh_username": "vagrant",
            "ssh_password": "vagrant",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "http_directory": "manifests",
            "boot_command": [
                "<tab> text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/centos/generic.ks<enter>"
            ]
        }
    ],

    "provisioners": [
        {
            "type": "shell",
            "execute_command": "echo 'vagrant' | {{ .Vars }} sudo -E -S bash '{{ .Path }}'",
            "inline": [
                "yum install -y perl bzip2 gcc kernel-devel kernel-headers dkms",
                "yum upgrade -y",
                "reboot",
                "sleep 60"
            ]
        }, {
            "type": "shell",
            "execute_command": "echo 'vagrant' | {{ .Vars }} sudo -E -S bash '{{ .Path }}'",
            "scripts": [
                "manifests/centos/preinstall.sh"
            ]
        }, {
            "type": "puppet-masterless",
            "manifest_file": "manifests/centos/trafficserver.pp"
        }
    ],

    "post-processors": [
        {
            "type": "vagrant",
            "output": "boxes/{{.BuildName}}-x64-{{.Provider}}.box",
            "compression_level": 9
        }
    ]
}

